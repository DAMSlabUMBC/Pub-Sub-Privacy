# Benchmark settings
node_name: "B1"
all_benchmark_names:
    - "B1"
client_module_name: "ClientInterface"
output_dir: "logs"

# Registration topics for PM purposes
reg_by_msg_reg_topic: "$DAP/purpose_management"
reg_by_topic_pub_reg_topic: "$DAP/MP_reg"
reg_by_topic_sub_reg_topic: "$DAP/SP_reg"

# Operational topic settings
or_topic_name: "OR"
ors_topic_name: "ORS"
on_topic_name: "ON"
onp_topic_name: "ONP"
osys_topic_name: "$OSYS"
operational_response_topic_prefix: "op_resp"
operational_purpose: "DAP_op"

# Broker settings
purpose_management_method: 2

# Broker monitoring 
monitor_broker: true
node_exporter_url: "http://localhost:9100/metrics"
monitor_interval_ms: 1000

# Purpose definitions 
purpose_definitions:
    - id: "health_monitoring"
      description: "Healthcare vital signs"
    - id: "location_tracking"
      description: "GPS location data"
    - id: "diagnostics"
      description: "Device diagnostics"

# Device definitions 
# These define reusable device types with specific publication properties
device_definitions:
    - id: "heart_rate_sensor"
      type: "publisher"
      topic: "health/heart_rate"
      initial_purpose: "health_monitoring"
      pub_period_ms: 1000  # Publish every 1 second
      min_payload_bytes: 100
      max_payload_bytes: 150

    - id: "gps_tracker"
      type: "publisher"
      topic: "location/gps"
      initial_purpose: "location_tracking"
      pub_period_ms: 5000  # Publish every 5 seconds
      min_payload_bytes: 200
      max_payload_bytes: 300

    - id: "health_subscriber"
      type: "subscriber"
      topic_filter: "health/#"
      purpose_filter: "health_monitoring"

    - id: "location_subscriber"
      type: "subscriber"
      topic_filter: "location/#"
      purpose_filter: "location_tracking"

test:
    # Base test parameters
    name: "DeterministicTest1"
    duration_ms: 300000  # 5 minutes
    data_qos: 0

    # Use deterministic scheduling instead of random behavior
    use_deterministic_scheduling: true

    # Device instances 
    # Creates specific instances of devices from device_definitions
    device_instances:
        - device_def_id: "heart_rate_sensor"
          instance_id: "hr_sensor_1"
          count: 1
        - device_def_id: "gps_tracker"
          instance_id: "gps_1"
          count: 1
        - device_def_id: "health_subscriber"
          instance_id: "health_sub_1"
          count: 1
        - device_def_id: "location_subscriber"
          instance_id: "loc_sub_1"
          count: 1

    # Scheduled events 
    # Events occur at exact times (deterministic, no randomness)
    scheduled_events:
        - time_ms: 0
          type: "connect_all"
          description: "Connect all publishers and subscribers"

        - time_ms: 1000
          type: "start_publishing"
          devices: ["hr_sensor_1", "gps_1"]

        - time_ms: 120000  # 2 minutes in
          type: "change_purpose"
          device: "hr_sensor_1"
          new_purpose: "diagnostics"

        - time_ms: 180000  # 3 minutes in
          type: "disconnect"
          devices: ["gps_1"]

        - time_ms: 240000  # 4 minutes in
          type: "reconnect"
          devices: ["gps_1"]

        - time_ms: 290000  # Near end
          type: "stop_publishing"
          devices: ["hr_sensor_1", "gps_1"]

        - time_ms: 300000
          type: "disconnect_all"

    # Legacy fields for backward compatibility
    client_count: 0
    topics_subbed_by_client_pct: 1.0
    topics: []
    topic_filters: []
    purposes: []
    purpose_filters: []
    pub_period_ms: 0
    clients_publishing_per_timestep_pct: 0
    topics_per_pub_pct: 0
    purpose_shuffle_period_ms: 0
    purpose_shuffle_chance: 0
    min_payload_length_bytes: 0
    max_payload_length_bytes: 0
